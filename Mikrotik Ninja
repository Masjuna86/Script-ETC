## Mikrotik Ninja : Hide Routerboard Info From Isp / Wan Scanning
## Date: Thu Jan 01 2026 23:53:45 GMT+0700 (Western Indonesia Time)
## Script generated by Juna

## Crucial step: Do not select the incorrect interface. Be sure to choose the ether interface that connects to the ISP.
/interface list add name=WAN-PROTECT comment="MikroTik Ninja by Juna"
/interface list member add interface="ether1-WAN" list=WAN-PROTECT comment="MikroTik Ninja by Juna"

## --- Change Identity ---
## MikroTik Router broadcasts Identity name via Neighbor Discovery, this is why identity must be disguised.
/system identity set name="Powerful-Router-979"

## --- Auto Random Mac Address ---
## This Auto Random MAC Address Script runs in the scheduler, and the MAC Interface facing the ISP will always change every time the router restarts. To disguise the router to appear as a modem, laptop, switch, printer, etc.
/system scheduler add name="Random MAC Address" on-event=":local hash ([/certificate scep-server otp generate minutes-valid=0 as-value]->\"password\")\r\n:local mac1 [:pick \$hash 0 2]\r\n:local mac2 [:pick \$hash 2 4]\r\n:local mac3 [:pick \$hash 4 6]\r\n:local mac4 [:pick \$hash 6 8]\r\n:local mac5 [:pick \$hash 8 10]\r\n:local mac6 [:pick \$hash 10 12]\r\n:local macAddr \"\$mac1:\$mac2:\$mac3:\$mac4:\$mac5:\$mac6\"\r\n/interface ethernet set \"ether1-WAN\" mac-address=\$macAddr" policy=read,write,test start-time=startup comment="Random MAC Address by Juna"

## --- Block Winbox Scan ---
## Prevent ISP from scanning Winbox from ports (21,22,23,8291,80,443,8728,8729)
/ip firewall filter add action=drop chain=input dst-port=21,22,23,8291,80,443,8728,8729 in-interface-list=WAN-PROTECT protocol=tcp comment="Block Winbox Scan - by Juna"
/ip firewall filter add action=drop chain=input dst-port=21,22,23,8291,80,443,8728,8729 in-interface-list=WAN-PROTECT protocol=udp

## --- Block Neighbor Discovery ---
## Hide router from discovery protocol
/ip firewall filter add action=drop chain=input in-interface-list=WAN-PROTECT dst-port=5678 protocol=tcp comment="Block Neighbor Discovery - by Juna"
/ip firewall filter add action=drop chain=input in-interface-list=WAN-PROTECT dst-port=5678 protocol=udp
/ip neighbor discovery-settings set discover-interface-list=!WAN-PROTECT

## --- Block MAC Address ---
## Disable MAC Server service from WAN
/ip firewall filter add action=drop chain=input in-interface-list=WAN-PROTECT dst-port=20561 protocol=tcp comment="Block MAC Address - by Juna"
/ip firewall filter add action=drop chain=input in-interface-list=WAN-PROTECT dst-port=20561 protocol=udp
/tool mac-server mac-winbox set allowed-interface-list=none
/tool mac-server set allowed-interface-list=none
/tool mac-server ping set enabled=no

## --- Block Traceroute ---
## Prevent traceroute detection from ISP
/ip firewall filter add action=drop chain=input in-interface-list=WAN-PROTECT dst-port=33434-33534 protocol=tcp comment="Block Traceroute - by Juna"
/ip firewall filter add action=drop chain=input in-interface-list=WAN-PROTECT dst-port=33434-33534 protocol=udp

## --- Block RoMON ---
## Disable RoMON from public interface
/tool romon port add disabled=no forbid=yes interface="ether1-WAN" comment="Block RoMON - by Juna"

## --- Block DNS Poisoning ---
## Block queries to common DNS resolvers from outside
/ip firewall filter add chain=input dst-port=53 in-interface-list=WAN-PROTECT protocol=tcp action=drop comment="Block Open Recursive DNS - by Juna"
/ip firewall filter add chain=input dst-port=53 in-interface-list=WAN-PROTECT protocol=udp action=drop

## --- Block Open PROXY ---
## Prevent router from becoming an open proxy relay
/ip proxy set enabled=no
/ip firewall filter add action=drop chain=input dst-port=3128,8080 in-interface-list=WAN-PROTECT protocol=tcp comment="Block Open PROXY - by Juna"
/ip firewall filter add action=drop chain=input dst-port=3128,8080 in-interface-list=WAN-PROTECT protocol=udp

## --- Block SOCKS Proxy ---
## Prevent the use of MikroTik internal proxy features
/ip firewall filter add action=drop chain=input dst-port=1080 in-interface-list=WAN-PROTECT protocol=tcp comment="Block SOCKS Proxy - by Juna"
/ip firewall filter add action=drop chain=input dst-port=1080 in-interface-list=WAN-PROTECT protocol=udp

## --- Block ICMP Echo (Ping) ---
## Do not reply to pings from the internet
/ip firewall filter add chain=input protocol=icmp icmp-options=8:0 in-interface-list=WAN-PROTECT action=drop comment="Drop Ping from WAN - by Juna"

## --- Block SSDP / UPnP ---
## Close SSDP/UPnP broadcast service
/ip firewall filter add chain=input protocol=udp dst-port=1900 in-interface-list=WAN-PROTECT action=drop comment="Block SSDP / UPnP - by Juna"
/ip firewall filter add chain=input protocol=tcp dst-port=1900 in-interface-list=WAN-PROTECT action=drop

## --- Block BTest Server ---
## Prevent bandwidth tests to/from the router
/tool bandwidth-server set enabled=no authenticate=yes
/ip firewall filter add action=drop chain=input dst-port=2000 in-interface-list=WAN-PROTECT protocol=tcp comment="Block BTest Server - by Juna"
/ip firewall filter add action=drop chain=input dst-port=2000 in-interface-list=WAN-PROTECT protocol=udp

## --- Block SNMP ---
## Close SNMP port (UDP 161) from outside
/snmp set enabled=no
/ip firewall filter add action=drop chain=input dst-port=161,162 in-interface-list=WAN-PROTECT protocol=tcp comment="Block SNMP - by Juna"
/ip firewall filter add action=drop chain=input dst-port=161,162 in-interface-list=WAN-PROTECT protocol=udp

## --- Block The Dude ---
## Block The Dude monitoring ports (2210-2215)
/ip firewall filter add action=drop chain=input dst-port=2210,2211 in-interface-list=WAN-PROTECT protocol=tcp comment="Block The Dude - by Juna"
/ip firewall filter add action=drop chain=input dst-port=2210,2211 in-interface-list=WAN-PROTECT protocol=udp

## --- Block IP Cloud ---
## Disable MikroTik Cloud DDNS service
## --- v7.xx Disable
/ip cloud set ddns-enabled=auto
## --- v6.xx Disable
/ip cloud set ddns-enabled=no
/ip cloud advanced set use-local-address=no
/ip cloud set update-time=no

## --- Log Port Scanner ---
## Detect and log port scan attempts
/ip firewall filter add chain=input protocol=tcp dst-port=22,23,80,8291,2000 log=yes log-prefix="PORT-SCAN" action=add-src-to-address-list address-list=port-scanner address-list-timeout=1d comment="Log Port Scan - by Juna"

## --- Mask TTL (change TTL to 65) ---
## Obfuscate TTL so the router is not detected by ISP fingerprinting
/ip firewall mangle add action=change-ttl chain=postrouting new-ttl=set:65 out-interface-list=WAN-PROTECT comment="Mask TTL - by Juna"

## --- Drop Bogon IP ---
## Reject fake (non-routable/bogon) IPs from WAN
/ip firewall address-list add list=Bogon address=0.0.0.0/8 comment="Bogon: Current Network"
/ip firewall address-list add list=Bogon address=10.0.0.0/8 comment="Bogon: Private Class A"
/ip firewall address-list add list=Bogon address=100.64.0.0/10 comment="Bogon: Shared Address Space"
/ip firewall address-list add list=Bogon address=127.0.0.0/8 comment="Bogon: Loopback"
/ip firewall address-list add list=Bogon address=169.254.0.0/16 comment="Bogon: Link-Local"
/ip firewall address-list add list=Bogon address=172.16.0.0/12 comment="Bogon: Private Class B"
/ip firewall address-list add list=Bogon address=192.0.0.0/24 comment="Bogon: IANA IPv4 Special Purpose"
/ip firewall address-list add list=Bogon address=192.0.2.0/24 comment="Bogon: TEST-NET-1"
/ip firewall address-list add list=Bogon address=192.88.99.0/24 comment="Bogon: 6to4 Relay Anycast"
/ip firewall address-list add list=Bogon address=192.168.0.0/16 comment="Bogon: Private Class C"
/ip firewall address-list add list=Bogon address=198.18.0.0/15 comment="Bogon: Benchmarking"
/ip firewall address-list add list=Bogon address=198.51.100.0/24 comment="Bogon: TEST-NET-2"
/ip firewall address-list add list=Bogon address=203.0.113.0/24 comment="Bogon: TEST-NET-3"
/ip firewall address-list add list=Bogon address=224.0.0.0/4 comment="Bogon: Multicast"
/ip firewall address-list add list=Bogon address=240.0.0.0/4 comment="Bogon: Reserved for Future Use"
/ip firewall filter add chain=input src-address-list=Bogon in-interface-list=WAN-PROTECT action=drop comment="Drop Bogon IP - by Juna"

## --- Disable All IP Services ---
## Disable all IP services (telnet, www, ftp, etc.) from WAN except SSH, WINBOX
/ip service disable telnet
/ip service disable ftp
/ip service disable www
/ip service disable www-ssl
/ip service disable api
/ip service disable api-ssl
